/*
 *
 * Wijmo Library 1.4.1
 * http://wijmo.com/
 *
 * Copyright(c) ComponentOne, LLC.  All rights reserved.
 * 
 * Dual licensed under the Wijmo Commercial or GNU GPL Version 3 licenses.
 * licensing@wijmo.com
 * http://wijmo.com/license
 *
 *
 **/
(function(){"use strict";if(!window.Raphael)return;Raphael.fn.tri=function(b,c,e){var g=b,j=c-e,a=Math.cos(Math.PI/6)*e,d=Math.tan(Math.PI/3)*a,h=b+a,k=c+d,i=b-a,l=c+d,f=["M",g,j,"L",h,k,"L",i,l,"z"];return this.path(f.concat(" "))};Raphael.fn.invertedTri=function(b,c,e){var g=b,j=c+e,a=Math.cos(Math.PI/6)*e,d=Math.tan(Math.PI/3)*a,h=b+a,k=c-d,i=b-a,l=c-d,f=["M",g,j,"L",h,k,"L",i,l,"z"];return this.path(f.concat(" "))};Raphael.fn.box=function(b,c,e){var a=Math.cos(Math.PI/4)*e,d=["M",b-a,c-a,"L",b+a,c-a,"L",b+a,c+a,"L",b-a,c+a,"z"];return this.path(d.concat(" "))};Raphael.fn.diamond=function(b,c,a){var d=["M",b,c-a,"L",b+a,c,"L",b,c+a,"L",b-a,c,"z"];return this.path(d.concat(" "))};Raphael.fn.cross=function(b,c,e){var a=Math.cos(Math.PI/4)*e,d=["M",b-a,c-a,"L",b+a,c+a,"M",b-a,c+a,"L",b+a,c-a];return this.path(d.concat(" "))}})();(function(a){"use strict";a.widget("wijmo.wijlinechart",a.wijmo.wijchartcore,{options:{animation:{enabled:true,direction:"horizontal",duration:2e3,easing:">"},seriesTransition:{enabled:true,duration:2e3,easing:">"},zoomOnHover:true,mouseDown:null,mouseUp:null,mouseOver:null,mouseOut:null,mouseMove:null,click:null},_create:function(){var b=this;a.wijmo.wijchartcore.prototype._create.apply(b,arguments);b.chartElement.addClass("wijmo-wijlinechart");b.paths=[];b.shadowPaths=[];b.markersSet=[];b.animationSet=b.canvas.set();b.symbols=[];b.hoverPoint=null;b.hoverLine=null;b.linesStyle=[];b.shadow=true},destroy:function(){var b=this;b.chartElement.removeClass("wijmo-wijlinechart");a.wijmo.wijchartcore.prototype.destroy.apply(b,arguments);if(b.aniPathsAttr&&b.aniPathsAttr.length){a.each(b.aniPathsAttr,function(b,a){a=null});b.aniPathsAttr=null}},getLinePath:function(a){return this.paths[a]},getLineMarkers:function(a){var b=this.options,c;return b.seriesList&&b.seriesList[a].markers&&b.seriesList[a].markers.visible?this.markersSet[a]:c},_getAnchors:function(j,k,a,b,l,m){var n=(a-j)/2,o=(l-a)/2,c=Math.atan((a-j)/Math.abs(b-k)),d=Math.atan((l-a)/Math.abs(b-m)),e=0,f=0,h=0,g=0,i=0;c=k<b?Math.PI-c:c;d=m<b?Math.PI-d:d;e=Math.PI/2-(c+d)%(Math.PI*2)/2;f=n*Math.sin(e+c);h=n*Math.cos(e+c);g=o*Math.sin(e+d);i=o*Math.cos(e+d);return{x1:a-f,y1:b+h,x2:a+g,y2:b+i}},_paintLegend:function(){var j=this.options,b=0,l=0,p=0,g=null,k=j.seriesList,o=j.seriesStyles,c=null,h=null,d=null,m=0,n=0,e=null,f=null,i=null;a.extend(true,j,{legend:{size:{width:30,height:3}}});a.wijmo.wijchartcore.prototype._paintLegend.apply(this,arguments);if(j.legend.visible){if(this.legends.length&&this.legendIcons.length)for(b=0,l=this.legendIcons.length;b<l;b++){g=this.legendIcons[b];g.attr({fill:g.attr("stroke")})}if(!j.legend.reversed)for(b=0,l=k.length;b<l;b++){c=k[b];h=o[b];if(c.legendEntry){if(c.markers&&c.markers.visible){g=this.legendIcons[b];d=g.wijGetBBox();m=d.x+d.width/2;n=d.y+d.height/2;e=c.markerStyle;e=a.extend({fill:h.stroke,stroke:h.stroke,opacity:1},e);f=c.markers.type;if(!f)f="circle";i=this._paintMarker(f,m,n,3);i.attr(e);this.legendEles.push(i)}p++}}else for(b=k.length-1;b>=0;b--){c=k[b];h=o[b];if(c.legendEntry&&c.markers.visible){if(c.markers.visible){g=this.legendIcons[b];d=g.wijGetBBox();m=d.x+d.width/2;n=d.y+d.height/2;e=c.markerStyle;e=a.extend({fill:h.stroke,stroke:h.stroke,opacity:1},e);f=c.markers.type;if(!f)f="circle";i=this._paintMarker(f,m,n,3);i.attr(e)}p++}}}},_clearChartElement:function(){var b=this;b.linesStyle=[];if(b.paths.length){a.each(b.paths,function(b,a){a.wijRemove();a=null});b.paths=[]}if(b.shadowPaths.length){a.each(b.shadowPaths,function(b,a){a.wijRemove();a=null});b.shadowPaths=[]}if(b.markersSet.length){a.each(b.markersSet,function(c,b){a.each(b,function(b,a){a.wijRemove();a=null});b=null});b.markersSet=[]}if(b.animationSet.length){a.each(b.animationSet,function(b,a){a.wijRemove();a=null});b.animationSet=b.canvas.set()}if(b.symbols.length){a.each(b.symbols,function(b,a){a.wijRemove();a=null});b.symbols=[]}a.wijmo.wijchartcore.prototype._clearChartElement.apply(b,arguments)},_paintMarker:function(f,d,e,b){var c=this,a=null;switch(f){case"circle":a=c.canvas.circle(d,e,b);break;case"tri":a=c.canvas.tri(d,e,b);break;case"invertedTri":a=c.canvas.invertedTri(d,e,b);break;case"box":a=c.canvas.box(d,e,b);break;case"diamond":a=c.canvas.diamond(d,e,b);break;case"cross":a=c.canvas.cross(d,e,b)}return a},_getPathArrByFitType:function(a,n,b,u,e,q,r,c,d,y,z,g,t){var j=null,k=null,w=0,x=0,o=0,p=0,h=null,i=null,f=null,s=g.minY,l=g.minX,m=g.kx,v=g.ky;if(n==="line")a=a.concat([b?"L":"M",c,d]);else if(n==="spline")if(!b)a=["M",c,d,"C",c,d];else if(b&&b<u-1){j=r[b-1];k=r[b+1];if(z){j=this._toOADate(j);k=this._toOADate(k)}w=e.endY-(j-s)*v;x=e.endY-(k-s)*v;if(isNaN(t)||typeof t==="string"){o=e.startX+(b-1-l)*m;p=e.startX+(b+1-l)*m}else{h=q[b-1];i=q[b+1];if(y){h=this._toOADate(h);i=this._toOADate(i)}o=e.startX+(h-l)*m;p=e.startX+(i-l)*m}f=this._getAnchors(o,w,c,d,p,x);a=a.concat([f.x1,f.y1,c,d,f.x2,f.y2])}else a=a.concat([c,d,c,d]);else if(n==="bezier")if(!b)a=a.concat(["M",c,d]);else if(b===u-1&&b%2===1)a=a.concat(["Q",c,d,c,d]);else if(b%2===0)a=a.concat([c,d]);else a=a.concat(["Q",c,d]);return a},_paintPlotArea:function(){var b=this,f=b.options,q=f.animation,l=q.duration,o=q.easing,h=f.seriesTransition,g=b.canvasBounds,V=g.endX-g.startX,H=g.endY-g.startY,P=f.seriesList,nb=f.seriesStyles,K,jb,j,X,i,kb,L,mb,r,A,c,ab,S,y,N,w,Z,D=f.axis.x.min,I=f.axis.y.min,W=f.axis.x.max,ib=f.axis.y.max,lb=V/(W-D),Y=H/(ib-I),eb={minX:D,minY:I,maxX:W,maxY:ib,width:V,height:H,kx:lb,ky:Y},gb=b.axisInfo.x.isTime,C=b.axisInfo.y.isTime,U,n,m,G,fb,Q,u,p,t,F,v,hb,e,R,T,db,cb,k,d,s,bb=[],M,O,z,B,E,x,J;b.plotInfos=[];for(i=0,kb=P.length;i<kb;i++){M=[];O=[];x=[];c=P[i];ab=nb[i];c=a.extend(true,{fitType:"line",markers:{visible:false,type:"circle"},visible:true},c);S=c.data;y=a.extend({stroke:"black",opacity:1,fill:"none","stroke-linejoin":"round","stroke-linecap":"round"},ab);w=c.markerStyle;w=a.extend({fill:y.stroke,stroke:y.stroke,opacity:1,width:3},w);N=f.seriesHoverStyles[i];Z=a.extend(true,{},N,{scale:"1.5 1.5","stroke-width":1},P.markerHoverStyle);U=S.x;n=S.y;b.plotInfos.push(eb);m=b.canvas.set();G=[];fb=c.fitType;Q=false;if(c.markers.symbol&&c.markers.symbol.length)Q=true;u=b.canvas.set();if(!b.aniPathsAttr||q.enabled&&!h.enabled)if(n.length>0){B=n[0];if(C)B=b._toOADate(B);E=n[n.length-1];if(C)E=b._toOADate(E)}for(j=0,X=n.length;j<X;j++){p=U[j];if(gb)p=b._toOADate(p);t=n[j];if(C)t=b._toOADate(t);if(p===undefined)break;r=0;if(isNaN(p)||typeof p==="string")J=j;else J=p;r=g.startX+(J-D)*lb;A=g.endY-(t-I)*Y;if(!b.aniPathsAttr||q.enabled&&!h.enabled){z=B+(E-B)/(W-D)*(J-D);z=g.endY-(z-I)*Y;if(j===0)x.push("M");else x.push("L");x.push(r);x.push(z)}G=b._getPathArrByFitType(G,fb,j,X,g,U,n,r,A,gb,C,eb,p,t);if(f.showChartLabels){F=C?b._fromOADate(t):t;if(f.chartLabelFormatString&&f.chartLabelFormatString.length)F=a.format(F,f.chartLabelFormatString);v=b.canvas.text(r,A,F);b.chartLabelEles.push(v);hb=v.wijGetBBox();v.translate(0,-hb.height);u.push(v);O.push(a.extend(true,{},v.attr()))}e=null;R=false;if(Q){T=c.markers.symbol;for(L=0,mb=T.length;L<mb;L++){s=T[L];if(s.index===j){e=b.canvas.image(s.url,r-s.width/2,A-s.height/2,s.width,s.height);b.symbols.push(e);R=true;if(!b.aniPathsAttr||q.enabled&&!h.enabled)e.straight=z;break}}}if(e===null){db=c.markers.type;cb=w.width;e=b._paintMarker(db,r,A,cb);c.markers.visible&&e.attr(w);if(!b.aniPathsAttr||q.enabled&&!h.enabled)e.straight=z}b._addClass(a(e.node),"wijchart-canvas-object wijchart-canvas-marker");k={};k.marker=e;k.index=j;k.type="marker";k.lineSeries=c;k.x=r;k.y=A;k.isSymbol=R;a(e.node).data("wijchartDataObj",k);m.push(e);M.push(a.extend(true,{},e.attr()));b.animationSet.push(e)}d=b.canvas.path(G.join(" "));d.straight=x.join(" ");b._paintShadow(d);d.wijAttr(y);bb.push({path:a.extend(true,{},d.attr()),markers:M,labels:O});d.markers=m;b.paths[i]=d;if(d.shadow)b.shadowPaths[i]=d.shadow;b.animationSet.push(d);b.linesStyle[i]={lineStyle:y,lineHoverStyle:N,markerStyle:w,markerHoverStyle:Z};!c.markers.visible&&m.hide();if(!c.visible){d.hide();d.shadow&&d.shadow.hide()}c.markers.style&&m.attr(c.markers.style);m.toFront();if(u.length){u.attr(f.chartLabelStyle);u.toFront();d.labels=u}b.markersSet[i]=m;c.index=i;c.type="line";c.path=d;c.lineMarkers=m;c.lineStyle=y;b._addClass(a(d.node),"wijchart-canvas-object");a(d.node).data("wijchartDataObj",c)}if(q.enabled||h.enabled&&b.seriesTransition)if(q.direction==="horizontal"){if(h.enabled&&b.seriesTransition){l=h.duration;o=h.easing}b.animationSet.wijAttr("clip-rect",g.startX+" "+g.startY+" 0 "+H);b.animationSet.wijAnimate({"clip-rect":g.startX+" "+g.startY+" "+V+" "+H},l,o,function(){if(Raphael.vml)for(K=0,jb=b.animationSet.length;K<jb;K++){var c=b.animationSet[K],e=null,f=null,d=null;if(c.node.clipRect){e=c.attrs;delete e["clip-rect"];c.node.clipRect=null;f=a(c.node).parent();d=f.parent();d.before(f);d.remove();c.attr(e)}}})}else a.each(b.paths,function(g,c){var d,e,f;if(b.aniPathsAttr&&h.enabled){l=h.duration;o=h.easing;c.shadow&&c.shadow.hide();d=b.aniPathsAttr[g];e=b._getDiffAttrs(d.path,c.attr());c.attr(d.path);c.wijAnimate(e,l,o,function(){c.shadow&&c.shadow.show()});a.each(c.markers,function(c,a){var e=b._getDiffAttrs(d.markers[c],a.attr());a.attr(d.markers[c]);a.wijAnimate(e,l,o)});c.labels&&a.each(c.labels,function(e,c){var f=b._getDiffAttrs(d.labels[e],c.attr()),a=d.labels[e];if(a&&a.text)delete a.text;c.attr(a);c.wijAnimate(f,l,o)})}else if(c.straight){c.shadow&&c.shadow.hide();d=c.straight;f=c.attr().path;c.attr({path:d});c.wijAnimate({path:f},l,o,function(){c.shadow&&c.shadow.show()});a.each(c.markers,function(c,a){if(a.straight){var b=a.attr().cy;a.attr({cy:a.straight});a.wijAnimate({cy:b},l,o)}})}});b.aniPathsAttr=bb},_getChartLabelPointPosition:function(m){var b=this,n=b.options,o=m.attachMethod,f=m.attachMethodData,h={x:0,y:0},e=null,g=null,c=0,d=0,i=0,j=0,a=null,l=null,k=null;switch(o){case"coordinate":h.x=f.x;h.y=f.y;break;case"dataCoordinate":e=f.seriesIndex;if(e>-1){g=b.plotInfos;if(g.length>e){c=f.x;d=f.y;if(b._isDate(c))c=b._toOADate(c);if(this._isDate(d))d=b._toOADate(d);a=g[e];i=a.width/(a.maxX-a.minX);h.x=b.canvasBounds.startX+(c-a.minX)*i;j=a.height/(a.maxY-a.minY);h.y=b.canvasBounds.startY+a.height-(d-a.minY)*j}}break;case"dataIndex":e=f.seriesIndex;k=f.pointIndex;l=n.seriesList[e].data;c=l.x[k];d=l.y[k];if(b._isDate(c))c=b._toOADate(c);if(this._isDate(d))d=b._toOADate(d);if(e>-1){g=b.plotInfos;if(g.length>e){a=g[e];i=a.width/(a.maxX-a.minX);h.x=b.canvasBounds.startX+(c-a.minX)*i;j=a.height/(a.maxY-a.minY);h.y=b.canvasBounds.startY+a.height-(d-a.minY)*j}}break;case"dataIndexY":e=f.seriesIndex;k=f.pointIndex;l=n.seriesList[e].data;c=l.x[k];d=f.y;if(b._isDate(c))c=b._toOADate(c);if(b._isDate(d))d=b._toOADate(d);if(e>-1){g=b.plotInfos;if(g.length>e){a=g[e];i=a.width/(a.maxX-a.minX);h.x=b.canvasBounds.startX+(c-a.minX)*i;j=a.height/(a.maxY-a.minY);h.y=b.canvasBounds.startY+a.height-(d-a.minY)*j}}}return h},_bindLiveEvents:function(){var b=this,f=false,e=this.options,c={element:this.chartElement,mousedown:function(c){if(e.disabled)return;var g=a(c.target),f=a(c.target).data("wijchartDataObj"),d=null;if(g.hasClass("wijchart-canvas-marker")){d=f.lineSeries;if(!d.markers.visible)b._trigger("mouseDown",c,d);else b._trigger("mouseDown",c,f)}else b._trigger("mouseDown",c,f)},mouseup:function(c){if(e.disabled)return;var g=a(c.target),f=a(c.target).data("wijchartDataObj"),d=null;if(g.hasClass("wijchart-canvas-marker")){d=f.lineSeries;if(!d.markers.visible)b._trigger("mouseUp",c,d);else b._trigger("mouseUp",c,f)}else b._trigger("mouseUp",c,f)},mouseover:function(i){if(e.disabled)return;var j=a(i.target),d=a(i.target).data("wijchartDataObj"),h=null,c=null,g=0;if(j.hasClass("wijchart-canvas-marker")){h=d.lineSeries;if(!h.markers.visible)b._trigger("mouseOver",i,h);else b._trigger("mouseOver",i,d);if(b.hoverLine!==h){f=true;if(b.hoverLine){g=b.hoverLine.index;c=b.linesStyle[g];b.hoverLine.path.wijAttr(c.lineStyle);if(b.hoverPoint&&!b.hoverPoint.isSymbol){b.hoverPoint.marker.wijAttr(c.markerStyle);b.hoverPoint.marker.scale(1,1)}}g=h.index;c=b.linesStyle[g];c&&c.lineHoverStyle&&h.path.wijAttr(c.lineHoverStyle);b.hoverLine=h;b.hoverPoint=null}}else{b._trigger("mouseOver",i,d);if(d.type!=="line")return;if(b.hoverLine!==d){f=true;if(b.hoverLine){g=b.hoverLine.index;c=b.linesStyle[g];b.hoverLine.path.wijAttr(c.lineStyle);if(b.hoverPoint&&!b.hoverPoint.isSymbol){b.hoverPoint.marker.wijAttr(c.markerStyle);b.hoverPoint.marker.scale(1,1)}}g=d.index;c=b.linesStyle[g];c&&c.lineHoverStyle&&d.path.wijAttr(c.lineHoverStyle);b.hoverLine=d;b.hoverPoint=null}}},mouseout:function(c){if(e.disabled)return;var g=a(c.target),f=a(c.target).data("wijchartDataObj"),d=null;if(g.hasClass("wijchart-canvas-marker")){d=f.lineSeries;if(!d.markers.visible)b._trigger("mouseOut",c,d);else b._trigger("mouseOut",c,f)}else b._trigger("mouseOut",c,f)},mousemove:function(c){if(e.disabled)return;var g=a(c.target),f=a(c.target).data("wijchartDataObj"),d=null;if(g.hasClass("wijchart-canvas-marker")){d=f.lineSeries;if(!d.markers.visible)b._trigger("mouseMove",c,d);else b._trigger("mouseMove",c,f)}else b._trigger("mouseMove",c,f)},click:function(c){if(e.disabled)return;var g=a(c.target),f=a(c.target).data("wijchartDataObj"),d=null;if(g.hasClass("wijchart-canvas-marker")){d=f.lineSeries;if(!d.markers.visible)b._trigger("click",c,d);else b._trigger("click",c,f)}else b._trigger("click",c,f)}},d=e.hint,i=null,g=b.canvasBounds,h=b.chartElement.offset();a(".wijchart-canvas-object",this.chartElement[0]).live("mousedown.wijlinechart",a.proxy(c.mousedown,c)).live("mouseup.wijlinechart",a.proxy(c.mouseup,c)).live("mouseover.wijlinechart",a.proxy(c.mouseover,c)).live("mouseout.wijlinechart",a.proxy(c.mouseout,c)).live("mousemove.wijlinechart",a.proxy(c.mousemove,c)).live("click.wijlinechart",a.proxy(c.click,c));if(d.enable){i=a.extend(true,d,{closeBehavior:"none",mouseTrailing:false,triggers:"custom",compass:d.compass});if(!this.tooltip)this.tooltip=this.canvas.tooltip(null,i)}this.chartElement.bind("mousemove",function(B){if(e.disabled)return;h=b.chartElement.offset();var m={left:B.pageX-h.left,top:B.pageY-h.top},v=null,c=0,u=0,z=0,j=null,r=0,q=0,n=null,t=null,l=null,o,p,k=null,C=null,i=null,s=null,A=d.title,y=d.content,x=a.isFunction(A),w=a.isFunction(y);if(b.tooltip)s=b.tooltip.getOptions();if(m.left>=g.startX&&m.left<=g.endX&&m.top>=g.startY&&m.top<=g.endY){if(b.hoverLine){if(f){d.enable&&b.tooltip&&b.tooltip.hide();f=false}v=b.hoverLine.lineMarkers;c=-1;t={x:0,y:0};a.each(v,function(a,b){j=b.wijGetBBox();r=j.x+j.width/2;q=Math.abs(r-m.left);if(a===0){u=q;c=a;t={x:r,y:j.y+j.height/2}}else if(q<u){u=q;c=a;t={x:r,y:j.y+j.height/2}}});if(b.hoverPoint&&b.hoverPoint.index===c)return;if(c>-1){n=a(v[c].node).data("wijchartDataObj");if(n){z=b.hoverLine.index;l=b.linesStyle[z];if(b.hoverPoint&&!b.hoverPoint.isSymbol){b.hoverPoint.marker.wijAttr(l.markerStyle);b.hoverPoint.marker.scale(1,1)}!n.isSymbol&&n.marker.wijAttr(l.markerHoverStyle)}b.hoverPoint=n}if(d.enable&&b.tooltip){k=b.hoverLine.data;if(k.x){o=k.x[c];p=k.y[c]}else{o=k.xy[2*c];p=k.xy[2*c+1]}i=b.hoverPoint;if(x||w){if(x)s.title=function(){var b={pointIndex:c,lineIndex:i.lineSeries.index,x:o,y:p,label:i.lineSeries.label,data:i,fmt:A},d=a.proxy(b.fmt,b),e=d();return e};if(w)s.content=function(){var b={pointIndex:c,lineIndex:i.lineSeries.index,x:o,y:p,label:i.lineSeries.label,data:i,fmt:y},e=a.proxy(b.fmt,b),d=e();return d}}C=a.extend({stroke:b.hoverLine.path.attr("stroke")},d.style);s.style.stroke=C.stroke;b.tooltip.showAt(t)}}}else{d.enable&&b.tooltip&&b.tooltip.hide();if(b.hoverLine){c=b.hoverLine.index;l=b.linesStyle[c];b.hoverLine.path.wijAttr(l.lineStyle);if(b.hoverPoint&&!b.hoverPoint.isSymbol){b.hoverPoint.marker.wijAttr(l.markerStyle);b.hoverPoint.marker.scale(1,1)}}b.hoverLine=null;b.hoverPoint=null}})},_unbindLiveEvents:function(){a(".wijchart-canvas-object",this.chartElement[0]).die("wijlinechart")}})})(jQuery);